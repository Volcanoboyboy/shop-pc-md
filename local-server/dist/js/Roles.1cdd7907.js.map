{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/views/Roles.vue?e3f9","webpack:///./src/views/Roles.vue?dd6e","webpack:///src/views/Roles.vue","webpack:///./src/views/Roles.vue?d4b3","webpack:///./src/views/Roles.vue"],"names":["$","$find","find","addToUnscopables","arrayMethodUsesToLength","FIND","SKIPS_HOLES","USES_TO_LENGTH","Array","target","proto","forced","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","_v","on","$event","addRoleDialog","visible","staticStyle","roles","scopedSlots","_u","key","fn","ref","row","children","_e","_l","v1","id","delRight","_s","authName","v2","v3","editRoleDialog","open","delRole","assignRights","assignRightsDialog","title","$set","rights","label","proxy","onCancel","onOk","form","data","rules","model","value","callback","$$v","trim","expression","showP","staticRenderFns","name","isShowP","roleName","roleDesc","role","rightIdsOfLeaf","methods","$nextTick","recursionFn","rgiths","forEach","v","mounted","loadRoles","component"],"mappings":"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","file":"js/Roles.1cdd7907.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND);\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Roles.vue?vue&type=style&index=0&id=3563385b&lang=less&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Roles.vue?vue&type=style&index=0&id=3563385b&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"roles\"},[_c('el-breadcrumb',{attrs:{\"separator\":\"/\"}},[_c('el-breadcrumb-item',[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"权限管理\")]),_c('el-breadcrumb-item',[_vm._v(\"角色列表\")])],1),_c('el-card',{staticClass:\"box-card\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.addRoleDialog.visible = true}}},[_vm._v(\"添加角色\")])],1)],1),_c('el-row',{staticStyle:{\"margin-top\":\"20px\"}},[_c('el-col',{attrs:{\"span\":24}},[_c('el-table',{attrs:{\"border\":\"\",\"data\":_vm.roles}},[_c('el-table-column',{attrs:{\"type\":\"expand\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [(!row.children || row.children.length === 0)?[_vm._v(\" 暂无权限 \")]:_vm._e(),_vm._l((row.children),function(v1){return _c('el-row',{key:v1.id,staticClass:\"level1-row\"},[_c('el-col',{attrs:{\"span\":4}},[_c('el-tag',{attrs:{\"closable\":\"\"},on:{\"close\":function($event){return _vm.delRight(v1, row)}}},[_vm._v(_vm._s(v1.authName))]),_c('i',{staticClass:\"el-icon-caret-right\"})],1),_c('el-col',{attrs:{\"span\":20}},_vm._l((v1.children),function(v2){return _c('el-row',{key:v2.id,staticClass:\"level2-row\"},[_c('el-col',{attrs:{\"span\":6}},[_c('el-tag',{attrs:{\"closable\":\"\",\"type\":\"success\"},on:{\"close\":function($event){return _vm.delRight(v2, row)}}},[_vm._v(_vm._s(v2.authName))]),_c('i',{staticClass:\"el-icon-caret-right\"})],1),_c('el-col',{attrs:{\"span\":18}},_vm._l((v2.children),function(v3){return _c('el-tag',{key:v3.id,staticStyle:{\"margin\":\"5px 10px 5px 0\"},attrs:{\"closable\":\"\",\"type\":\"warning\"},on:{\"close\":function($event){return _vm.delRight(v3, row)}}},[_vm._v(_vm._s(v3.authName))])}),1)],1)}),1)],1)})]}}])}),_c('el-table-column',{attrs:{\"label\":\"#\",\"type\":\"index\"}}),_c('el-table-column',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}}),_c('el-table-column',{attrs:{\"label\":\"角色描述\",\"prop\":\"roleDesc\"}}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('el-button',{attrs:{\"icon\":\"el-icon-edit\",\"size\":\"mini\",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.editRoleDialog.open(row)}}}),_c('el-button',{attrs:{\"icon\":\"el-icon-delete\",\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.delRole(row)}}}),_c('el-button',{attrs:{\"icon\":\"el-icon-setting\",\"size\":\"mini\",\"type\":\"warning\"},on:{\"click\":function($event){return _vm.assignRights(row)}}},[_vm._v(\"分配权限\")])]}}])})],1)],1)],1)],1),_c('el-dialog',{attrs:{\"title\":_vm.assignRightsDialog.title,\"visible\":_vm.assignRightsDialog.visible},on:{\"update:visible\":function($event){return _vm.$set(_vm.assignRightsDialog, \"visible\", $event)}},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('el-tree',{ref:\"assignRightsDialogTreeRef\",attrs:{\"default-expand-all\":\"\",\"show-checkbox\":\"\",\"data\":_vm.rights,\"node-key\":\"id\",\"props\":{\n          /* 指定子节点字段，默认值就是children */\n          children: 'children',\n          /* 指定节点名称字段，默认值是label */\n          label: 'authName',\n        }}})]},proxy:true},{key:\"footer\",fn:function(){return [_c('el-button',{on:{\"click\":_vm.assignRightsDialog.onCancel}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.assignRightsDialog.onOk}},[_vm._v(\"确 定\")])]},proxy:true}])}),_c('el-dialog',{attrs:{\"title\":_vm.addRoleDialog.title,\"visible\":_vm.addRoleDialog.visible},on:{\"update:visible\":function($event){return _vm.$set(_vm.addRoleDialog, \"visible\", $event)}},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('el-form',{ref:\"addRoleFormRef\",attrs:{\"label-width\":\"80px\",\"model\":_vm.addRoleDialog.form.data,\"rules\":_vm.addRoleDialog.form.rules}},[_c('el-form-item',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}},[_c('el-input',{model:{value:(_vm.addRoleDialog.form.data.roleName),callback:function ($$v) {_vm.$set(_vm.addRoleDialog.form.data, \"roleName\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"addRoleDialog.form.data.roleName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"角色描述\",\"prop\":\"roleDesc\"}},[_c('el-input',{model:{value:(_vm.addRoleDialog.form.data.roleDesc),callback:function ($$v) {_vm.$set(_vm.addRoleDialog.form.data, \"roleDesc\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"addRoleDialog.form.data.roleDesc\"}})],1)],1)]},proxy:true},{key:\"footer\",fn:function(){return [_c('el-button',{on:{\"click\":_vm.addRoleDialog.onCancel}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.addRoleDialog.onOk}},[_vm._v(\"确 定\")])]},proxy:true}])}),_c('el-dialog',{attrs:{\"title\":_vm.editRoleDialog.title,\"visible\":_vm.editRoleDialog.visible},on:{\"update:visible\":function($event){return _vm.$set(_vm.editRoleDialog, \"visible\", $event)}},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('el-form',{ref:\"editRoleFormRef\",attrs:{\"label-width\":\"80px\",\"model\":_vm.editRoleDialog.form.data,\"rules\":_vm.editRoleDialog.form.rules}},[_c('el-form-item',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}},[_c('el-input',{model:{value:(_vm.editRoleDialog.form.data.roleName),callback:function ($$v) {_vm.$set(_vm.editRoleDialog.form.data, \"roleName\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"editRoleDialog.form.data.roleName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"角色描述\",\"prop\":\"roleDesc\"}},[_c('el-input',{model:{value:(_vm.editRoleDialog.form.data.roleDesc),callback:function ($$v) {_vm.$set(_vm.editRoleDialog.form.data, \"roleDesc\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"editRoleDialog.form.data.roleDesc\"}})],1)],1)]},proxy:true},{key:\"footer\",fn:function(){return [_c('el-button',{on:{\"click\":_vm.editRoleDialog.onCancel}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editRoleDialog.onOk}},[_vm._v(\"确 定\")])]},proxy:true}])}),(_vm.isShowP)?_c('p',{attrs:{\"id\":\"ppp\"}},[_vm._v(\"asdfkjalsdkfjalsdfkjalsdkfjl\")]):_vm._e(),_c('button',{on:{\"click\":_vm.showP}},[_vm._v(\"showP\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"roles\">\n    <el-breadcrumb separator=\"/\">\n      <el-breadcrumb-item>首页</el-breadcrumb-item>\n      <el-breadcrumb-item>权限管理</el-breadcrumb-item>\n      <el-breadcrumb-item>角色列表</el-breadcrumb-item>\n    </el-breadcrumb>\n    <el-card class=\"box-card\">\n      <!-- 头部按钮 -->\n      <el-row>\n        <el-col :span=\"24\">\n          <el-button type=\"primary\" @click=\"addRoleDialog.visible = true\">添加角色</el-button>\n        </el-col>\n      </el-row>\n\n      <!-- 表格 -->\n      <el-row style=\"margin-top: 20px;\">\n        <el-col :span=\"24\">\n          <el-table border :data=\"roles\">\n            <el-table-column type=\"expand\">\n              <template #default=\"{ row }\">\n                <template v-if=\"!row.children || row.children.length === 0\">\n                  暂无权限\n                </template>\n\n                <!-- 遍历一级权限 -->\n                <el-row v-for=\"v1 in row.children\" :key=\"v1.id\" class=\"level1-row\">\n                  <el-col :span=\"4\">\n                    <el-tag closable @close=\"delRight(v1, row)\">{{ v1.authName }}</el-tag>\n                    <i class=\"el-icon-caret-right\"></i>\n                  </el-col>\n                  <el-col :span=\"20\">\n                    <!-- 嵌套遍历二级权限 -->\n                    <el-row v-for=\"v2 in v1.children\" :key=\"v2.id\" class=\"level2-row\">\n                      <el-col :span=\"6\">\n                        <el-tag closable type=\"success\" @close=\"delRight(v2, row)\">{{ v2.authName }}</el-tag>\n                        <i class=\"el-icon-caret-right\"></i>\n                      </el-col>\n                      <el-col :span=\"18\">\n                        <!-- 嵌套遍历三级权限 -->\n                        <el-tag\n                          closable\n                          v-for=\"v3 in v2.children\"\n                          :key=\"v3.id\"\n                          type=\"warning\"\n                          style=\"margin: 5px 10px 5px 0;\"\n                          @close=\"delRight(v3, row)\"\n                          >{{ v3.authName }}</el-tag\n                        >\n                      </el-col>\n                    </el-row>\n                  </el-col>\n                </el-row>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"#\" type=\"index\"></el-table-column>\n            <el-table-column label=\"角色名称\" prop=\"roleName\"></el-table-column>\n            <el-table-column label=\"角色描述\" prop=\"roleDesc\"></el-table-column>\n            <el-table-column label=\"操作\">\n              <template #default=\"{ row }\">\n                <el-button icon=\"el-icon-edit\" size=\"mini\" type=\"primary\" @click=\"editRoleDialog.open(row)\"></el-button>\n                <el-button icon=\"el-icon-delete\" size=\"mini\" type=\"danger\" @click=\"delRole(row)\"></el-button>\n                <el-button icon=\"el-icon-setting\" size=\"mini\" type=\"warning\" @click=\"assignRights(row)\"\n                  >分配权限</el-button\n                >\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-col>\n      </el-row>\n    </el-card>\n\n    <el-dialog :title=\"assignRightsDialog.title\" :visible.sync=\"assignRightsDialog.visible\">\n      <template #default>\n        <!-- node-key 每个树节点用来作为唯一标识的属性（数据中的字段键名） -->\n        <!-- default-checked-keys 这个默认选中的节点只会渲染一次 -->\n        <!-- :default-checked-keys=\"assignRightsDialog.rightIdsOfLeaf\"，说明：这个配置只会生效一次，第二次会有问题 -->\n        <el-tree\n          ref=\"assignRightsDialogTreeRef\"\n          default-expand-all\n          show-checkbox\n          :data=\"rights\"\n          node-key=\"id\"\n          :props=\"{\n            /* 指定子节点字段，默认值就是children */\n            children: 'children',\n            /* 指定节点名称字段，默认值是label */\n            label: 'authName',\n          }\"\n        ></el-tree>\n      </template>\n\n      <template #footer>\n        <el-button @click=\"assignRightsDialog.onCancel\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"assignRightsDialog.onOk\">确 定</el-button>\n      </template>\n    </el-dialog>\n\n    <el-dialog :title=\"addRoleDialog.title\" :visible.sync=\"addRoleDialog.visible\">\n      <template #default>\n        <el-form\n          ref=\"addRoleFormRef\"\n          label-width=\"80px\"\n          :model=\"addRoleDialog.form.data\"\n          :rules=\"addRoleDialog.form.rules\"\n        >\n          <el-form-item label=\"角色名称\" prop=\"roleName\">\n            <el-input v-model.trim=\"addRoleDialog.form.data.roleName\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"角色描述\" prop=\"roleDesc\">\n            <el-input v-model.trim=\"addRoleDialog.form.data.roleDesc\"></el-input>\n          </el-form-item>\n        </el-form>\n      </template>\n      <template #footer>\n        <el-button @click=\"addRoleDialog.onCancel\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addRoleDialog.onOk\">确 定</el-button>\n      </template>\n    </el-dialog>\n\n    <el-dialog :title=\"editRoleDialog.title\" :visible.sync=\"editRoleDialog.visible\">\n      <template #default>\n        <el-form\n          ref=\"editRoleFormRef\"\n          label-width=\"80px\"\n          :model=\"editRoleDialog.form.data\"\n          :rules=\"editRoleDialog.form.rules\"\n        >\n          <el-form-item label=\"角色名称\" prop=\"roleName\">\n            <el-input v-model.trim=\"editRoleDialog.form.data.roleName\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"角色描述\" prop=\"roleDesc\">\n            <el-input v-model.trim=\"editRoleDialog.form.data.roleDesc\"></el-input>\n          </el-form-item>\n        </el-form>\n      </template>\n      <template #footer>\n        <el-button @click=\"editRoleDialog.onCancel\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"editRoleDialog.onOk\">确 定</el-button>\n      </template>\n    </el-dialog>\n\n    <p id=\"ppp\" v-if=\"isShowP\">asdfkjalsdkfjalsdfkjalsdkfjl</p>\n    <button @click=\"showP\">showP</button>\n  </div>\n</template>\n\n<script>\n// 标记变量：是否加载过权限数据\nlet isLoadedOfRigths = false;\n\nexport default {\n  name: 'Roles',\n  data() {\n    return {\n      // 测试代码\n      isShowP: false,\n\n      // 添加角色对话框配置对象\n      addRoleDialog: {\n        visible: false,\n        title: '添加角色',\n        form: {\n          data: {\n            roleName: '',\n            roleDesc: '',\n          },\n          rules: {\n            roleName: [{ required: true, message: '请输入角色名称' }],\n            roleDesc: [{ required: true, message: '请输入角色描述' }],\n          },\n        },\n        onOk: async () => {\n          // 1. 验证表单数据是否合法\n          try {\n            await this.$refs.addRoleFormRef.validate();\n            // 2. 如果合法，则发请求\n            const res = await this.$request.post('roles', this.addRoleDialog.form.data);\n            if (res.data.meta.status === 201) {\n              // 2.1. 请求成功，才关闭对话框\n              this.addRoleDialog.visible = false;\n              // 2.2. 刷新列表数据\n              this.loadRoles();\n              // 2.3. 重置表单\n              this.$refs.addRoleFormRef.resetFields();\n            } else {\n              //  2.2. 请求失败，给个this.$message.error提示\n              this.$message.error(res.data.meta.msg);\n            }\n          } catch (err) {}\n          // 3. 否则不用处理\n        },\n        onCancel: () => {\n          this.addRoleDialog.visible = false;\n        },\n      },\n\n      // 编辑角色对话框配置数据\n      editRoleDialog: {\n        visible: false,\n        title: '编辑角色',\n        role: null, // 用来保存当前编辑的角色对象数据\n        form: {\n          data: {\n            roleName: '',\n            roleDesc: '',\n          },\n          rules: {\n            roleName: [{ required: true, message: '请输入角色名称' }],\n            roleDesc: [{ required: true, message: '请输入角色描述' }],\n          },\n        },\n        onOk: async () => {\n          // 1. 验证表单数据是否合法\n          try {\n            await this.$refs.editRoleFormRef.validate();\n            // 2. 如果合法，则发请求\n            const res = await this.$request.put(`roles/${this.editRoleDialog.role.id}`, this.editRoleDialog.form.data);\n            if (res.data.meta.status === 200) {\n              // 2.1. 请求成功，才关闭对话框\n              this.editRoleDialog.visible = false;\n              // 2.2. 更新列表中该角色的名称和描述即可，无需重新加载所有的角色数据\n              this.editRoleDialog.role.roleName = this.editRoleDialog.form.data.roleName;\n              this.editRoleDialog.role.roleDesc = this.editRoleDialog.form.data.roleDesc;\n            } else {\n              //  2.2. 请求失败，给个this.$message.error提示\n              this.$message.error(res.data.meta.msg);\n            }\n          } catch (err) {}\n          // 3. 否则不用处理\n        },\n        onCancel: () => {\n          this.editRoleDialog.visible = false;\n        },\n        open: (role) => {\n          this.editRoleDialog.role = role;\n          this.editRoleDialog.form.data.roleName = role.roleName;\n          this.editRoleDialog.form.data.roleDesc = role.roleDesc;\n          this.editRoleDialog.visible = true;\n        },\n      },\n\n      rights: [], // 用来保存所有可选的权限树形数据\n      roles: [],\n      // 分配权限对话框的配置\n      assignRightsDialog: {\n        title: '分配权限', // 标题\n        visible: false, // 控制显示隐藏\n        role: null, // 用来保存当前操作的角色对象\n        rightIdsOfLeaf: [], // 保存当前角色拥有的叶子权限id集合\n        // 这里不写箭头函数的话，函数内部的this指向不是vm实例，而是undefined\n        // onOK() {},\n        onOk: async () => {\n          // 1. 先要获取到用户在树形组件中选择的权限\n          // 1.1. 要获取所有选中的节点的key（包括叶子节点和非叶子节点）\n          const checkedKeys = this.$refs.assignRightsDialogTreeRef.getCheckedKeys(false /* 是否仅包含叶子节点 */);\n          // 1.2. 要获取所有半选中的节点的key\n          const halfCheckedKeys = this.$refs.assignRightsDialogTreeRef.getHalfCheckedKeys();\n          // 1.3. 要把 所有选中的节点的key 和 所有半选中的节点的key 合并到一起，在转换成以逗号\",\"隔开的字符串，传递给后台接口\n          const rids = checkedKeys.concat(halfCheckedKeys).join(',');\n          // 2. 请求后台接口，设置该角色的权限\n          const res = await this.$request.post(`roles/${this.assignRightsDialog.role.id}/rights`, { rids });\n          if (res.data.meta.status === 200) {\n            this.$message.success('授权成功');\n            // 3. 设置完后，再来关闭对话框\n            this.assignRightsDialog.visible = false;\n            // 4. 设置完后，刷新角色数据\n            // this.loadRoles();\n\n            const role = await this.getRoleById(this.assignRightsDialog.role.id);\n            // console.log(role, '最新的包含权限数据的role信息');\n            // 用最新的数据替换列表中旧的角色数据\n            this.assignRightsDialog.role.children = role.children;\n          } else {\n            this.$message.error(res.data.meta.msg);\n          }\n        },\n        onCancel: () => {\n          this.assignRightsDialog.visible = false;\n        },\n      },\n    };\n  },\n  methods: {\n    showP() {\n      // 数据的赋值是同步操作，但是DOM的渲染是异步操作\n      this.isShowP = true; // 显示p标签\n      // 如果能过拿到p标签，说明在执行这行代码时，P标签已经显示在页面中了\n      // 如果拿不到，说明在执行这行代码时，P标签还木有显示在页面中，说明vue是异步渲染DOM的\n      console.log(document.getElementById('ppp'), '马上获取的#ppp');\n      // this.$nextTick方法会等待真正的DOM渲染完后，再调用其回调\n      this.$nextTick(() => {\n        console.log(document.getElementById('ppp'), '在$nextTick中获取#ppp');\n      });\n    },\n\n    async delRole(role) {\n      // 1. 弹出一个确认框，防止用户误点\n      try {\n        await this.$confirm(`你确定要删除 \"${role.roleName}\" 吗？`, '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning',\n        });\n        // 2. 如果用户点击确认，则调用接口，删除该角色\n        const res = await this.$request.delete(`roles/${role.id}`);\n        if (res.data.meta.status === 200) {\n          // 2.1. 如果请求成功，则从所有的角色数组中剔除该角色即可，也无需请求所有的角色数据\n          // 从数组中删除元素：\n          // 方法1. 先把该角色的在数组中的索引找到（findIndex），然后通过数组的 (splice) 方法剔除该元素\n          // const index = this.roles.findIndex(v => v.id === role.id)\n          // this.roles.splice(index, 1);\n          // 方法2. 直接调用 (fitler) 方法，把被删除的角色过滤掉，将返回的新数组赋值给this.roles\n          this.roles = this.roles.filter((v) => v.id !== role.id);\n        } else {\n          // 2.2. 如果请求失败，则弹出消息框给用户提示即可\n          this.$message.error(res.data.meta.msg);\n        }\n      } catch (err) {}\n      // 3. 如果用户点击取消，关闭确认对话框即可\n    },\n\n    async delRight(right, role) {\n      const res = await this.$request.delete(`roles/${role.id}/rights/${right.id}`);\n      console.log(res, 'res...');\n      if (res.data.meta.status === 200) {\n        role.children = res.data.data;\n        this.$notify.success({ title: '成功', message: '删除成功' });\n      } else {\n        this.$message.error(res.data.meta.msg);\n      }\n    },\n\n    // 递归函数：用来处理角色拥有的权限id集合\n    recursionFn(rgiths) {\n      rgiths.forEach((v) => {\n        // 非叶子节点，继续递归\n        if (v.children && v.children.length > 0) {\n          this.recursionFn(v.children);\n        }\n        // 叶子节点，直接push到权限id集合中\n        else {\n          this.assignRightsDialog.rightIdsOfLeaf.push(v.id);\n        }\n      });\n    },\n    // 点击分配权限按钮时触发\n    async assignRights(role) {\n      // 清空当前角色拥有的叶子权限id集合\n      this.assignRightsDialog.rightIdsOfLeaf = [];\n\n      // 是否有加载过权限树形数据，如果没有加载过，就去请求后台接口获取所有权限树形数据\n      if (!isLoadedOfRigths) {\n        const res = await this.$request.get('rights/tree');\n        console.log(res, '树形权限数据');\n        if (res.data.meta.status === 200) {\n          // 保存数据\n          this.rights = res.data.data;\n          isLoadedOfRigths = true;\n        } else {\n          this.$message.error(res.data.meta.msg);\n        }\n      }\n\n      this.recursionFn(role.children);\n\n      this.assignRightsDialog.role = role;\n      this.assignRightsDialog.visible = true;\n\n      // $nextTick，会等待下一次DOM渲染完成后，调用其回调函数\n      // 因为我们的数据变了，并不会第一时间去更新DOM，Vue会等待所有的同步代码执行完后，再去根据最新的虚拟DOM，渲染出真正的DOM，是一个异步操作\n      this.$nextTick(() => {\n        // 通过调用el-tree组件实例的方法，来动态设置选中的节点，需要等待对话框显示出来后，再调用\n        this.$refs.assignRightsDialogTreeRef.setCheckedKeys(this.assignRightsDialog.rightIdsOfLeaf, true);\n      });\n    },\n    // 加载所有角色数据\n    async loadRoles() {\n      const res = await this.$request.get('roles');\n      if (res.data.meta.status === 200) {\n        this.roles = res.data.data;\n      } else {\n        this.$message.error(res.data.meta.msg);\n      }\n    },\n    // 根据角色id获取该角色的数据\n    async getRoleById(id) {\n      // 由于后台根据ID获取角色信息的接口，返回的数据中并没有包含该角色的权限，所以，我们需要自己根据所有角色数据封装一下\n      const res = await this.$request.get('roles');\n      if (res.data.meta.status === 200) {\n        // 从获取的所有角色列表中，找出该id的角色，返回出去\n        return res.data.data.find((v) => v.id === id);\n      } else {\n        this.$message.error(res.data.meta.msg);\n      }\n    },\n  },\n  mounted() {\n    this.loadRoles();\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.box-card {\n  margin-top: 20px;\n\n  .level1-row {\n    display: flex;\n    align-items: center;\n    border-bottom: 1px solid #ddd;\n\n    &:first-child {\n      border-top: 1px solid #ddd;\n    }\n\n    .level2-row {\n      display: flex;\n      align-items: center;\n      border-bottom: 1px solid #ddd;\n\n      &:last-child {\n        border-bottom: none;\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Roles.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Roles.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Roles.vue?vue&type=template&id=3563385b&scoped=true&\"\nimport script from \"./Roles.vue?vue&type=script&lang=js&\"\nexport * from \"./Roles.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Roles.vue?vue&type=style&index=0&id=3563385b&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3563385b\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}